(function(jsPDFAPI){'use strict';var fontName,fontSize,fontStyle,padding=3,margin=13,headerFunction,lastCellPos={x:undefined,y:undefined,w:undefined,h:undefined,ln:undefined},pages=1,setLastCellPosition=function(x,y,w,h,ln){lastCellPos={'x':x,'y':y,'w':w,'h':h,'ln':ln};},getLastCellPosition=function(){return lastCellPos;},NO_MARGINS={left:0,top:0,bottom:0};jsPDFAPI.setHeaderFunction=function(func){headerFunction=func;};jsPDFAPI.getTextDimensions=function(txt){fontName=this.internal.getFont().fontName;fontSize=this.table_font_size||this.internal.getFontSize();fontStyle=this.internal.getFont().fontStyle;var px2pt=0.264583*72/25.4,dimensions,text;text=document.createElement('font');text.id="jsPDFCell";text.style.fontStyle=fontStyle;text.style.fontName=fontName;text.style.fontSize=fontSize+'pt';text.innerText=txt;document.body.appendChild(text);dimensions={w:(text.offsetWidth+1)*px2pt,h:(text.offsetHeight+1)*px2pt};document.body.removeChild(text);return dimensions;};jsPDFAPI.cellAddPage=function(){var margins=this.margins||NO_MARGINS;this.addPage();setLastCellPosition(margins.left,margins.top,undefined,undefined);pages+=1;};jsPDFAPI.cellInitialize=function(){lastCellPos={x:undefined,y:undefined,w:undefined,h:undefined,ln:undefined};pages=1;};jsPDFAPI.cell=function(x,y,w,h,txt,ln,align){var curCell=getLastCellPosition();if(curCell.ln!==undefined){if(curCell.ln===ln){x=curCell.x+curCell.w;y=curCell.y;}else{var margins=this.margins||NO_MARGINS;if((curCell.y+curCell.h+h+margin)>=this.internal.pageSize.height-margins.bottom){this.cellAddPage();if(this.printHeaders&&this.tableHeaderRow){this.printHeaderRow(ln,true);}}y=(getLastCellPosition().y+getLastCellPosition().h);}}if(txt[0]!==undefined){if(this.printingHeaderRow){this.rect(x,y,w,h,'FD');}else{this.rect(x,y,w,h);}if(align==='right'){if(txt instanceof Array){for(var i=0;i<txt.length;i++){var currentLine=txt[i];var textSize=this.getStringUnitWidth(currentLine)*this.internal.getFontSize();this.text(currentLine,x+w-textSize-padding,y+this.internal.getLineHeight()*(i+1));}}}else{this.text(txt,x+padding,y+this.internal.getLineHeight());}}setLastCellPosition(x,y,w,h,ln);return this;};jsPDFAPI.arrayMax=function(array,comparisonFn){var max=array[0],i,ln,item;for(i=0,ln=array.length;i<ln;i+=1){item=array[i];if(comparisonFn){if(comparisonFn(max,item)===-1){max=item;}}else{if(item>max){max=item;}}}return max;};jsPDFAPI.table=function(x,y,data,headers,config){if(!data){throw'No data for PDF table';}var headerNames=[],headerPrompts=[],header,i,ln,cln,columnMatrix={},columnWidths={},columnData,column,columnMinWidths=[],j,tableHeaderConfigs=[],model,jln,func,autoSize=false,printHeaders=true,fontSize=12,margins=NO_MARGINS;margins.width=this.internal.pageSize.width;if(config){if(config.autoSize===true){autoSize=true;}if(config.printHeaders===false){printHeaders=false;}if(config.fontSize){fontSize=config.fontSize;}if(config.margins){margins=config.margins;}}this.lnMod=0;lastCellPos={x:undefined,y:undefined,w:undefined,h:undefined,ln:undefined},pages=1;this.printHeaders=printHeaders;this.margins=margins;this.setFontSize(fontSize);this.table_font_size=fontSize;if(headers===undefined||(headers===null)){headerNames=Object.keys(data[0]);}else if(headers[0]&&(typeof headers[0]!=='string')){var px2pt=0.264583*72/25.4;for(i=0,ln=headers.length;i<ln;i+=1){header=headers[i];headerNames.push(header.name);headerPrompts.push(header.prompt);columnWidths[header.name]=header.width*px2pt;}}else{headerNames=headers;}if(autoSize){func=function(rec){return rec[header];};for(i=0,ln=headerNames.length;i<ln;i+=1){header=headerNames[i];columnMatrix[header]=data.map(func);columnMinWidths.push(this.getTextDimensions(headerPrompts[i]||header).w);column=columnMatrix[header];for(j=0,cln=column.length;j<cln;j+=1){columnData=column[j];columnMinWidths.push(this.getTextDimensions(columnData).w);}columnWidths[header]=jsPDFAPI.arrayMax(columnMinWidths);}}if(printHeaders){var lineHeight=this.calculateLineHeight(headerNames,columnWidths,headerPrompts.length?headerPrompts:headerNames);for(i=0,ln=headerNames.length;i<ln;i+=1){header=headerNames[i];tableHeaderConfigs.push([x,y,columnWidths[header],lineHeight,String(headerPrompts.length?headerPrompts[i]:header)]);}this.setTableHeaderRow(tableHeaderConfigs);this.printHeaderRow(1,false);}for(i=0,ln=data.length;i<ln;i+=1){var lineHeight;model=data[i];lineHeight=this.calculateLineHeight(headerNames,columnWidths,model);for(j=0,jln=headerNames.length;j<jln;j+=1){header=headerNames[j];this.cell(x,y,columnWidths[header],lineHeight,model[header],i+2,header.align);}}this.lastCellPos=lastCellPos;this.table_x=x;this.table_y=y;return this;};jsPDFAPI.calculateLineHeight=function(headerNames,columnWidths,model){var header,lineHeight=0;for(var j=0;j<headerNames.length;j++){header=headerNames[j];model[header]=this.splitTextToSize(String(model[header]),columnWidths[header]-padding);var h=this.internal.getLineHeight()*model[header].length+padding;if(h>lineHeight)lineHeight=h;}return lineHeight;};jsPDFAPI.setTableHeaderRow=function(config){this.tableHeaderRow=config;};jsPDFAPI.printHeaderRow=function(lineNumber,new_page){if(!this.tableHeaderRow){throw'Property tableHeaderRow does not exist.';}var tableHeaderCell,tmpArray,i,ln;this.printingHeaderRow=true;if(headerFunction!==undefined){var position=headerFunction(this,pages);setLastCellPosition(position[0],position[1],position[2],position[3],-1);}this.setFontStyle('bold');var tempHeaderConf=[];for(i=0,ln=this.tableHeaderRow.length;i<ln;i+=1){this.setFillColor(200,200,200);tableHeaderCell=this.tableHeaderRow[i];if(new_page){tableHeaderCell[1]=this.margins&&this.margins.top||0;tempHeaderConf.push(tableHeaderCell);}tmpArray=[].concat(tableHeaderCell);this.cell.apply(this,tmpArray.concat(lineNumber));}if(tempHeaderConf.length>0){this.setTableHeaderRow(tempHeaderConf);}this.setFontStyle('normal');this.printingHeaderRow=false;};})(jsPDF.API);